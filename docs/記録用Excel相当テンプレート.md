# Phase 1 実験記録テンプレート（Excel/Numbers用）

## シート1: 実験基本情報

| 項目 | 値 | 備考 |
|------|-----|------|
| 実験ID | EXP_20241217_001 | |
| 実験日 | 2024/12/17 | |
| 開始時刻 | 14:00 | |
| 終了時刻 | 16:30 | |
| 実験者名 | | |
| 室温(℃) | 22 | |
| 湿度(%) | 45 | |
| M5StickC ID | #1 | #1/#2/#3 |
| ファームウェア | v0.1 | |
| 初期バッテリー(%) | 95 | |
| 最終バッテリー(%) | 78 | |

## シート2: BLE広告テスト

### 2-1. チェックリスト
| 項目 | OK/NG | 値 | 備考 |
|------|-------|-----|------|
| デバイス認識 | OK | M5HAR_01 | |
| Company ID | OK | 0x5900 | |
| 広告間隔確認 | OK | 100ms | |
| パケット受信 | OK | | |
| シーケンス番号 | OK | 0-255循環 | |

### 2-2. 測定値記録
| 時刻 | RSSI(dBm) | パケット数 | 間隔(ms) | 備考 |
|------|-----------|-----------|----------|------|
| 14:00 | -45 | 0 | - | 開始 |
| 14:01 | -47 | 600 | 100 | |
| 14:02 | -46 | 1200 | 100 | |
| 14:03 | -48 | 1800 | 100 | |
| 14:04 | -45 | 2400 | 100 | |
| 14:05 | -47 | 3000 | 100 | 終了 |

## シート3: IMU状態遷移テスト

### 3-1. 状態遷移記録
| 時刻 | 動作 | 期待状態 | 実際状態 | Uncertainty | 正解 | 備考 |
|------|------|----------|----------|-------------|------|------|
| 14:10:00 | 静止開始 | IDLE | IDLE | 0.10 | ○ | |
| 14:10:30 | 静止継続 | IDLE | IDLE | 0.12 | ○ | |
| 14:11:00 | 歩行開始 | ACTIVE | UNCERTAIN | 0.65 | △ | 遷移中 |
| 14:11:05 | 歩行 | ACTIVE | ACTIVE | 0.20 | ○ | |
| 14:11:30 | 歩行 | ACTIVE | ACTIVE | 0.18 | ○ | |
| 14:12:00 | ゆっくり | UNCERTAIN | UNCERTAIN | 0.75 | ○ | |
| 14:12:30 | 静止 | IDLE | IDLE | 0.15 | ○ | |
| 14:13:00 | 激しく振る | ACTIVE | ACTIVE | 0.25 | ○ | |

### 3-2. Uncertaintyサマリー
| 状態 | 最小値 | 最大値 | 平均値 | サンプル数 |
|------|--------|--------|--------|------------|
| IDLE | 0.10 | 0.20 | 0.14 | 120 |
| ACTIVE | 0.15 | 0.30 | 0.22 | 85 |
| UNCERTAIN | 0.60 | 0.85 | 0.72 | 35 |

### 3-3. 精度評価
| 指標 | 値 | 計算式 |
|------|-----|--------|
| 全体精度 | 92.5% | 222/240 |
| IDLE精度 | 95.0% | 114/120 |
| ACTIVE精度 | 91.8% | 78/85 |
| UNCERTAIN精度 | 85.7% | 30/35 |

## シート4: 電力測定テスト

### 4-1. 時系列記録（1分ごと）
| 経過時間 | 条件 | 電圧(V) | 電流(mA) | 電力(mW) | バッテリー(%) |
|---------|------|---------|----------|----------|---------------|
| 0:00 | アイドル | 3.70 | 5.2 | 19.24 | 95 |
| 1:00 | アイドル | 3.70 | 5.1 | 18.87 | 95 |
| 2:00 | BLE_100ms | 3.69 | 12.5 | 46.13 | 94 |
| 3:00 | BLE_100ms | 3.69 | 12.8 | 47.23 | 94 |
| 4:00 | BLE_100ms | 3.68 | 12.6 | 46.37 | 93 |
| 5:00 | BLE_100ms | 3.68 | 12.4 | 45.63 | 93 |
| 6:00 | BLE_100ms | 3.68 | 12.7 | 46.74 | 92 |
| 7:00 | BLE_2000ms | 3.68 | 8.2 | 30.18 | 92 |
| 8:00 | BLE_2000ms | 3.67 | 8.0 | 29.36 | 92 |
| 9:00 | BLE_2000ms | 3.67 | 8.3 | 30.46 | 91 |
| 10:00 | BLE_2000ms | 3.67 | 8.1 | 29.73 | 91 |
| 11:00 | BLE_2000ms | 3.67 | 8.2 | 30.09 | 91 |

### 4-2. 統計サマリー
| 条件 | 平均電流(mA) | 標準偏差 | 最大(mA) | 最小(mA) | 平均電力(mW) |
|------|-------------|----------|----------|----------|--------------|
| アイドル | 5.15 | 0.07 | 5.2 | 5.1 | 19.06 |
| BLE_100ms | 12.60 | 0.16 | 12.8 | 12.4 | 46.42 |
| BLE_2000ms | 8.16 | 0.11 | 8.3 | 8.0 | 29.96 |

### 4-3. 削減率計算
| 項目 | 値 | 計算式 |
|------|-----|--------|
| 100ms平均電流 | 12.60 mA | |
| 2000ms平均電流 | 8.16 mA | |
| 削減電流 | 4.44 mA | 12.60 - 8.16 |
| **削減率** | **35.2%** | 4.44 / 12.60 × 100 |

### 4-4. バッテリー寿命推定
| 条件 | 平均電流 | 推定寿命 | 計算式 |
|------|----------|----------|--------|
| BLE_100ms | 12.60 mA | 10.7時間 | 135mAh / 12.60 |
| BLE_2000ms | 8.16 mA | 16.5時間 | 135mAh / 8.16 |
| **延長率** | - | **1.54倍** | 16.5 / 10.7 |

## シート5: 統合テスト結果

### 5-1. シナリオ実行記録
| 時刻 | フェーズ | HAR状態 | BLE間隔(ms) | 電流(mA) | 備考 |
|------|---------|---------|-------------|----------|------|
| 0:00 | 静止(座位) | IDLE | 2000 | 8.2 | |
| 1:00 | 静止(座位) | IDLE | 2000 | 8.1 | |
| 2:00 | 歩行開始 | ACTIVE | 100 | 12.8 | 状態変化 |
| 2:30 | 歩行 | ACTIVE | 100 | 12.6 | |
| 3:00 | 静止(立位) | IDLE | 2000 | 8.3 | 状態変化 |
| 4:00 | 階段昇降 | ACTIVE | 100 | 13.2 | 状態変化 |
| 5:00 | 静止(座位) | IDLE | 2000 | 8.0 | 状態変化 |

### 5-2. パフォーマンス指標
| 指標 | 値 | 備考 |
|------|-----|------|
| 状態判定精度 | 18/20 (90%) | |
| 平均遅延 | 185 ms | |
| p50遅延 | 150 ms | |
| p95遅延 | 280 ms | |
| p99遅延 | 450 ms | |
| パケット損失率 | 2.3% | |
| 平均消費電流 | 9.8 mA | 全体平均 |

## シート6: 最終評価

### Phase 1 完了判定
| 判定項目 | 目標 | 実測 | 判定 | 備考 |
|---------|------|------|------|------|
| BLE広告安定性 | 100ms±10% | 100ms±3% | ✅ | |
| IMU状態判定 | 3状態 | 3状態 | ✅ | |
| 電力削減率 | ≥10% | 35.2% | ✅ | 優秀 |
| 連続動作 | ≥5分 | 30分 | ✅ | |
| データ品質 | CSV生成 | 完了 | ✅ | |

### 次フェーズ判定
| 削減率 | 判定基準 | 実測値 | 結果 |
|--------|---------|--------|------|
| ≥30% | 優秀 | **35.2%** | **✅ ESP32で本実装継続** |
| 20-30% | 良好 | - | - |
| 10-20% | 可 | - | - |
| <10% | 要再考 | - | - |

### 改善提案
1. Uncertainty閾値の最適化（現在: 0.3/0.7）
2. 状態遷移のヒステリシス追加
3. 移動平均フィルタの適用
4. バッファサイズの調整（現在: 100サンプル）

---

## 記録時の注意事項

1. **タイムスタンプ**: 必ず秒単位まで記録
2. **単位**: mA, ms, % など単位を明記
3. **異常値**: 背景を黄色でハイライト
4. **グラフ作成**: 
   - 電流プロファイル（時系列）
   - 削減率比較（棒グラフ）
   - 遅延分布（ヒストグラム）
5. **バックアップ**: 1時間ごとに保存

## CSVエクスポート形式

```csv
# power_data.csv
timestamp,condition,voltage_v,current_ma,power_mw,battery_pct
2024-12-17T14:00:00,idle,3.70,5.2,19.24,95
2024-12-17T14:01:00,idle,3.70,5.1,18.87,95
2024-12-17T14:02:00,ble_100ms,3.69,12.5,46.13,94
...
```

---
*テンプレートv1.0 - 2024-12-17*