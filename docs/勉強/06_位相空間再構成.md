# 位相空間再構成（Phase Space Reconstruction）

## 概要
1次元時系列データから高次元の動的システムの状態空間を再構成する手法。Takensの埋め込み定理に基づく。

## 基本概念

### Takensの埋め込み定理
元のシステムがd次元の場合、埋め込み次元m ≥ 2d+1であれば、元の動的特性を保存できる。

### 埋め込みベクトル
時系列 x(t) から以下のベクトルを構成：
```
X(t) = [x(t), x(t-τ), x(t-2τ), ..., x(t-(m-1)τ)]
```
- m: 埋め込み次元
- τ: 時間遅れ

## 実装での使用

### パラメータ選択
```swift
embeddingDim: Int = 5    // 埋め込み次元
delay: Int = 4           // 時間遅れ（サンプル数）
```

### 再構成アルゴリズム
```swift
for i in 0..<numPoints {
    var embedding: [Q15] = []
    for j in 0..<dimension {
        let index = i + j * delay
        embedding.append(timeSeries[index])
    }
    embeddings.append(embedding)
}
```

## なぜ必要か

### 1. 隠れた次元の復元
1次元の観測データから、元のシステムの多次元構造を復元。

### 2. アトラクタの可視化
カオスアトラクタなどの幾何学的構造が現れる。

### 3. 非線形解析の前処理
- Lyapunov指数計算
- 相関次元推定
- 予測モデル構築

## パラメータ選択の指針

### 時間遅れτの決定
1. **自己相関関数**: 最初のゼロ交差点
2. **相互情報量**: 最初の最小値
3. **実用的選択**: サンプリング周波数の1/10程度

### 埋め込み次元mの決定
1. **False Nearest Neighbors法**: 偽の近傍が消える次元
2. **経験則**: 3-10の範囲で試行
3. **計算コスト**: 次元増加で指数的に増大

## 実装での注意点

### メモリ効率
埋め込みにより、データサイズがm倍に増加。

### 境界処理
```swift
let numPoints = timeSeries.count - (dimension - 1) * delay
```
最後の (m-1)×τ サンプルは使用不可。

### SIMD最適化の機会
連続メモリアクセスのため、ベクトル化に適している。