# DFA (Detrended Fluctuation Analysis)

## 概要
時系列データの長期相関とフラクタル特性を評価する手法。心拍変動解析などで広く使用される。

## 基本概念

### DFAアルゴリズム
1. **累積和計算**: 平均を引いた信号の累積和を計算
2. **ボックス分割**: 様々なサイズのボックスに分割
3. **トレンド除去**: 各ボックス内で線形トレンドを除去
4. **揺らぎ計算**: 残差のRMS（二乗平均平方根）を計算
5. **スケーリング解析**: log(ボックスサイズ) vs log(揺らぎ)の傾き

### スケーリング指数α
- α = 0.5: ランダムウォーク（相関なし）
- α < 0.5: 反相関
- α > 0.5: 正の相関
- α = 1.0: 1/fノイズ
- α = 1.5: ブラウン運動

## 実装での最適化

### 1. SIMD累積和
```swift
let cumulativeSumInt32 = SIMDOptimizations.cumulativeSumSIMD(timeSeries, mean: mean)
```
オーバーフロー防止のためスケーリング（/256）を適用。

### 2. vDSPによる線形回帰
```swift
let (slope, intercept) = SIMDOptimizations.linearRegressionSIMD(x: x, y: boxData)
```

### 3. ボックスサイズの対数的増加
```swift
boxSize = Int(Float(boxSize) * 1.2)  // 20%ずつ増加
```

## なぜ重要か

### 生体信号解析
- **心拍変動**: 自律神経機能の評価
- **脳波**: 神経活動の複雑性評価
- **歩行**: 運動制御の安定性評価

### 異常検知への応用
- 正常時のαからの逸脱が疲労や病態を示唆
- リアルタイム処理により即座にフィードバック可能

## 実装での注意点
1. **オーバーフロー対策**: 累積和が大きくなるため、適切なスケーリング必須
2. **ボックスサイズ選択**: データ長の1/4以下に制限
3. **境界処理**: 端のボックスの扱いに注意