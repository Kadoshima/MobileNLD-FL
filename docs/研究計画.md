# MobileNLD-FL 研究計画

## 論文情報

### タイトル
- **日本語**: スマートフォン上での非線形歩行動力学解析と個人化連合オートエンコーダによる疲労異常検知
- **英語**: Fatigue Anomaly Detection via On-Device Nonlinear Gait Dynamics Analysis and Personalized Federated Autoencoder

### 投稿先
- **ジャーナル**: IEICE 和文論文誌 D
- **形式**: レター論文（6頁）

### プロジェクト名
**MobileNLD-FL** (Mobile Nonlinear Dynamics with Federated Learning)

## 研究概要

### 目的
スマートフォン単体で歩行の非線形動力学指標（リアプノフ指数，DFA）と心拍変動を実時間計算し，疲労状態を異常検知する手法の提案

### 主な成果
- 固定小数点演算により3秒窓の処理を4ミリ秒で実現（従来比22倍高速化）
- 個人化連合オートエンコーダによりAUC 0.13向上，通信量38%削減
- 市販端末のみで動作し，高価な外部機器やクラウド計算を不要化

## 研究の新規性

### N1: リアルタイム非線形解析
- スマートフォン単体でLyEとDFAをリアルタイム計算
- 3秒窓を4ms、固定小数q15実装の報告は国内初

### N2: 複合特徴による疲労検知
- NLD＋HRVを組み合わせた特徴が歩行疲労の異常検知に有効であることを初めて定量化
- AUC +0.09の改善を実証

### N3: 個人化連合学習の適用
- 共有エンコーダ／ローカルデコーダ構成の個人化連合オートエンコーダを gait/HRV 領域へ適用
- 通信量削減と精度向上を同時に実証

### N4: 簡便な評価手法
- 被験者１名でも「セッション分割 × 非IID シミュレーション」という簡便手法を提示
- 短期開発や初期テストで連合学習を評価可能

## 実験環境

### ハードウェア
- **メイン機器**: iPhone 13（A15 Bionic, iOS 17）
- **センサー**: 内蔵IMU 100Hz, 背面カメラPPG 30Hz
- **オプション**: Polar H10（心拍センサー）

### ソフトウェア
- **開発環境**: macOS + Xcode 15
- **言語**: Swift（iOS実装）, Python 3.11（ML実装）
- **MLフレームワーク**: Flower 1.6, TensorFlow 2.15

## 基本コンセプト

### 疲労の定義
- 疲労は「平常歩行パターンからの逸脱」として異常検知問題に帰着
- 歩行の時間構造（Lyapunov指数：安定性，DFA：複雑性）と自律神経応答（HRV）を同時観測

### プライバシー保護
- 計測・解析・推論のすべてをiPhone13（エッジノード）で完結
- 学習は複数利用者を想定した連合学習を採用

### 実験設計の工夫
- 被験者１名のデータを条件別セッションに分割
- 「セッション＝独立クライアント」としてFlowerシミュレータ上で評価

## 研究の意義

### 技術的意義
- 高価な外部センサやクラウド計算不要
- 消費電力も小さく日常使用可能な"プライバシー保護型疲労モニタ"の原型
- NLDという計算コストの高い指標を汎用スマホへ落とし込み

### 応用可能性
- 転倒リスク評価
- 神経疾患モニタリング
- MS、PD患者への展開

### 拡張性
- 個人化FLによりユーザ増加後もプライバシーを保護しながら精度向上可能

## 今後の方向性

1. **被験者の多人数化**: 公開データ統合による汎用性能検証
2. **センサー拡張**: BLE外部センサー（両下肢IMU）追加で空間パラメータも含む高精度モデル
3. **臨床評価**: 医療・介護現場での転倒予兆検出や神経疾患患者への展開
4. **クロスプラットフォーム**: Core ML ToolsやAndroid端末での実装